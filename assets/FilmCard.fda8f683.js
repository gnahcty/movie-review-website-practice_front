import{h,z as W,aR as se,aS as ne,r as w,c as P,w as B,a4 as oe,a3 as re,C as le,o as ue,M as ce,J as de,R as fe,A as J,aT as G,a2 as me,g as ve,I as ge,u as pe,p as he,j as C,k as R,d as u,s as v,x as M,q as $,Q as N,aU as K,ac as A,F as X,aj as ye,t as H,ag as Z,a5 as U,ah as be,v as we,ak as D}from"./index.3bc22c38.js";import{e as q,a as F,s as j,g as Le}from"./scroll.2f796c9f.js";import{Q as z}from"./QItem.d1c706a8.js";import{Q as _e,a as ke}from"./QMenu.05222aec.js";import{b as xe,Q as Se}from"./QList.50c5f906.js";import{Q as Ce}from"./QTooltip.32fc7aa6.js";import{Q as Qe}from"./QImg.b8f1cac9.js";import{C as O,Q as ee}from"./ClosePopup.2b154110.js";import{Q as te}from"./QCard.8ac245fb.js";import{Q as ae}from"./QInput.c1a2c3b4.js";import{Q as Te}from"./QCardSection.8fe112af.js";import{u as Ne}from"./use-quasar.a312dbff.js";import{u as Ee}from"./checkLogin.f02380d3.js";const Ie=[h("circle",{cx:"15",cy:"15",r:"15"},[h("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),h("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),h("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[h("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),h("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),h("circle",{cx:"105",cy:"15",r:"15"},[h("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),h("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])];var Ke=W({name:"QSpinnerDots",props:se,setup(l){const{cSize:i,classes:x}=ne(l);return()=>h("svg",{class:x.value,fill:"currentColor",width:i.value,height:i.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},Ie)}});const{passive:Q}=fe;var Xe=W({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:{default:void 0},initialIndex:Number,disable:Boolean,reverse:Boolean},emits:["load"],setup(l,{slots:i,emit:x}){const n=w(!1),o=w(!0),p=w(null),d=w(null);let f=l.initialIndex||0,e,c;const L=P(()=>"q-infinite-scroll__loading"+(n.value===!0?"":" invisible"));function y(){if(l.disable===!0||n.value===!0||o.value===!1)return;const r=q(e),s=F(e),k=G(e);l.reverse===!1?Math.round(s+k+l.offset)>=Math.round(r)&&S():Math.round(s)<=l.offset&&S()}function S(){if(l.disable===!0||n.value===!0||o.value===!1)return;f++,n.value=!0;const r=q(e);x("load",f,s=>{o.value===!0&&(n.value=!1,J(()=>{if(l.reverse===!0){const k=q(e),Y=F(e),ie=k-r;j(e,Y+ie)}s===!0?t():p.value&&p.value.closest("body")&&c()}))})}function E(){f=0}function T(){o.value===!1&&(o.value=!0,e.addEventListener("scroll",c,Q)),y()}function t(){o.value===!0&&(o.value=!1,n.value=!1,e.removeEventListener("scroll",c,Q),c!==void 0&&c.cancel!==void 0&&c.cancel())}function g(){if(e&&o.value===!0&&e.removeEventListener("scroll",c,Q),e=Le(p.value,l.scrollTarget),o.value===!0){if(e.addEventListener("scroll",c,Q),l.reverse===!0){const r=q(e),s=G(e);j(e,r-s)}y()}}function _(r){f=r}function b(r){r=parseInt(r,10);const s=c;c=r<=0?y:me(y,isNaN(r)===!0?100:r),e&&o.value===!0&&(s!==void 0&&e.removeEventListener("scroll",s,Q),e.addEventListener("scroll",c,Q))}function I(r){if(V.value===!0){if(d.value===null){r!==!0&&J(()=>{I(!0)});return}const s=`${n.value===!0?"un":""}pauseAnimations`;Array.from(d.value.getElementsByTagName("svg")).forEach(k=>{k[s]()})}}const V=P(()=>l.disable!==!0&&o.value===!0);B([n,V],()=>{I()}),B(()=>l.disable,r=>{r===!0?t():T()}),B(()=>l.reverse,()=>{n.value===!1&&o.value===!0&&y()}),B(()=>l.scrollTarget,g),B(()=>l.debounce,b);let m=!1;oe(()=>{m!==!1&&e&&j(e,m)}),re(()=>{m=e?F(e):!1}),le(()=>{o.value===!0&&e.removeEventListener("scroll",c,Q)}),ue(()=>{b(l.debounce),g(),n.value===!1&&I()});const a=ve();return Object.assign(a.proxy,{poll:()=>{c!==void 0&&c()},trigger:S,stop:t,reset:E,resume:T,setIndex:_}),()=>{const r=ce(i.default,[]);return V.value===!0&&r[l.reverse===!1?"push":"unshift"](h("div",{ref:d,class:L.value},de(i.loading))),h("div",{class:"q-infinite-scroll",ref:p},r)}}}),Ve=W({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(l,{slots:i,emit:x}){let n=!1,o,p,d=null,f=null,e,c;function L(){o&&o(),o=null,n=!1,d!==null&&(clearTimeout(d),d=null),f!==null&&(clearTimeout(f),f=null),p!==void 0&&p.removeEventListener("transitionend",e),e=null}function y(t,g,_){g!==void 0&&(t.style.height=`${g}px`),t.style.transition=`height ${l.duration}ms cubic-bezier(.25, .8, .50, 1)`,n=!0,o=_}function S(t,g){t.style.overflowY=null,t.style.height=null,t.style.transition=null,L(),g!==c&&x(g)}function E(t,g){let _=0;p=t,n===!0?(L(),_=t.offsetHeight===t.scrollHeight?0:void 0):(c="hide",t.style.overflowY="hidden"),y(t,_,g),d=setTimeout(()=>{d=null,t.style.height=`${t.scrollHeight}px`,e=b=>{f=null,(Object(b)!==b||b.target===t)&&S(t,"show")},t.addEventListener("transitionend",e),f=setTimeout(e,l.duration*1.1)},100)}function T(t,g){let _;p=t,n===!0?L():(c="show",t.style.overflowY="hidden",_=t.scrollHeight),y(t,_,g),d=setTimeout(()=>{d=null,t.style.height=0,e=b=>{f=null,(Object(b)!==b||b.target===t)&&S(t,"hide")},t.addEventListener("transitionend",e),f=setTimeout(e,l.duration*1.1)},100)}return le(()=>{n===!0&&L()}),()=>h(ge,{css:!1,appear:l.appear,onEnter:E,onLeave:T},i.default)}});const Be=H("div",{class:"text-left"}," WatchList",-1),De={class:"text-left"},Me=H("div",{class:"text-left"}," create a list",-1),$e={key:1,style:{width:"100%",height:"58px"}},qe={class:"relative"},Ze={__name:"FilmCard",props:{id:{type:Number,default:()=>0},title:{type:String,default:()=>""},poster_path:{type:String,default:()=>""},watched:{type:Boolean,default:()=>!1},like:{type:Boolean,default:()=>!1},comments:{type:String,default:()=>""},adult:{},backdrop_path:{},genre_ids:{},original_language:{},original_title:{},overview:{},popularity:{},release_date:{},video:{},vote_average:{},vote_count:{},ratings:{}},setup(l){const i=l,{loginTryCatch:x}=Ee(),n=pe(),o=Ne(),p=w(!1),d=w(""),f=w(""),e=w(i.watched),c=w(i.comments!==""),L=w(i.like),y=w(!1),S=w(null),E=P(function(){return m=>n.userLists[m].films.some(a=>a.id===i.id.toString())?"text-blue":"text-grey"}),T=P(()=>n.watchList.some(m=>m.id===i.id.toString())?"text-blue":"text-grey"),t=async()=>{e.value=!e.value,await D.post("/reviews/",{filmID:i.id,watched:e.value})},g=async()=>{L.value=!L.value,await D.post("/reviews/",{filmID:i.id,like:L.value})},_=()=>{d.value="",f.value=""},b=async()=>{if(d.value==="")o.notify({type:"warnings",message:"Please Enter a Title"});else try{const m={id:i.id,title:i.title,poster:i.poster_path},{data:a}=await D.post("lists/create",{name:d.value,description:f.value,films:[m]});n.userLists.push(a.newList),o.notify({type:"success",message:"Success!"})}catch{o.notify({type:"warnings",message:"something went wrong"})}},I=async m=>{try{const a={id:i.id,title:i.title,poster:i.poster_path},{data:r}=await D.post("lists/update",{_id:n.userLists[m]._id,film:a});n.userLists[m]=r.list}catch{o.notify({type:"warnings",message:"something went wrong"})}},V=async()=>{try{const m={filmID:i.id,title:i.title,poster:i.poster_path},{data:a}=await D.post("/users/watchlist",m);n.watchList=a.result}catch{o.notify({type:"warnings",message:"something went wrong"})}};return(m,a)=>{const r=he("RouterLink");return C(),R(X,null,[u(te,{class:"my-card",flat:"",bordered:"",style:{width:"80%"},onMouseleave:a[4]||(a[4]=s=>p.value=!1)},{default:v(()=>[M(n).isLogin?(C(),$(N,{key:0,flat:"",round:"",color:"grey",icon:"add",id:"add",class:"absolute-top-right",style:{"z-index":"2"}},{default:v(()=>[u(_e,null,{default:v(()=>[u(xe,{style:{"min-width":"150px"}},{default:v(()=>[u(z,{clickable:"",class:K(["row","items-center",T.value]),onClick:V},{default:v(()=>[u(A,{name:"more_time",class:"col-2 q-pr-sm"}),Be]),_:1},8,["class"]),(C(!0),R(X,null,ye(M(n).userLists,(s,k)=>(C(),$(z,{key:k,clickable:"",class:K(["row","items-center",E.value(k)]),onClick:Y=>I(k)},{default:v(()=>[u(A,{name:"segment",class:"col-2 q-pr-sm"}),H("div",De,Z(s.name),1)]),_:2},1032,["class","onClick"]))),128)),u(ke,{inset:""}),U((C(),$(z,{clickable:"",class:"row items-center",onClick:a[0]||(a[0]=s=>y.value=!0)},{default:v(()=>[u(A,{name:"add",class:"col-2 q-pr-sm"}),Me]),_:1})),[[O]])]),_:1})]),_:1})]),_:1})):be("",!0),u(r,{to:"/films/"+i.id},{default:v(()=>[u(Qe,{src:"https://image.tmdb.org/t/p/w300/"+i.poster_path,class:"ratio border5 rounded15",onMouseenter:a[1]||(a[1]=s=>p.value=!0),ref_key:"imgRef",ref:S},{default:v(()=>[u(Ce,{anchor:"center middle",self:"top middle"},{default:v(()=>[we(Z(l.title),1)]),_:1})]),_:1},8,["src"])]),_:1},8,["to"]),p.value?(C(),$(Ve,{key:2},{default:v(()=>[H("div",qe,[u(ee,{align:"center"},{default:v(()=>[u(N,{flat:"",round:"",color:e.value?"green":"grey",icon:"visibility",onClick:a[2]||(a[2]=s=>M(x)(t))},null,8,["color"]),u(N,{flat:"",round:"",color:c.value?"yellow":"grey",icon:"segment"},null,8,["color"]),u(N,{flat:"",round:"",color:L.value?"red":"grey",icon:"favorite",onClick:a[3]||(a[3]=s=>M(x)(g))},null,8,["color"])]),_:1})])]),_:1})):(C(),R("div",$e))]),_:1}),u(Se,{modelValue:y.value,"onUpdate:modelValue":a[7]||(a[7]=s=>y.value=s)},{default:v(()=>[u(te,{style:{"min-width":"450px"}},{default:v(()=>[u(Te,null,{default:v(()=>[u(ae,{rounded:"",outlined:"",modelValue:d.value,"onUpdate:modelValue":a[5]||(a[5]=s=>d.value=s),type:"text",label:"List Title",class:"q-mb-lg",rules:[s=>!!s||"List Title is Required"]},null,8,["modelValue","rules"]),u(ae,{rounded:"",filled:"",modelValue:f.value,"onUpdate:modelValue":a[6]||(a[6]=s=>f.value=s),type:"textarea",label:"list Description"},null,8,["modelValue"])]),_:1}),u(ee,{align:"center"},{default:v(()=>[U(u(N,{flat:"",label:"Cancel",type:"reset",color:"primary",onClick:_},null,512),[[O]]),U(u(N,{flat:"",label:"Submit",type:"submit",color:"primary",onClick:b},null,512),[[O]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{Xe as Q,Ze as _,Ke as a};
